{"ast":null,"code":"import _toConsumableArray from \"C:/Users/Asus/Desktop/house-marketing-main/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"C:/Users/Asus/Desktop/house-marketing-main/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Asus/Desktop/house-marketing-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:/Users/Asus/Desktop/house-marketing-main/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"C:/Users/Asus/Desktop/house-marketing-main/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:/Users/Asus/Desktop/house-marketing-main/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Asus\\\\Desktop\\\\house-marketing-main\\\\src\\\\pages\\\\CreateListing.jsx\",\n    _s = $RefreshSig$();\n\n// src/pages/CreateListing.jsx (Enhanced Tailwind UI for General Item Listings)\nimport { useState, useEffect, useRef } from 'react';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport { getStorage, ref, uploadBytesResumable, getDownloadURL } from 'firebase/storage';\nimport { addDoc, collection, serverTimestamp } from 'firebase/firestore';\nimport { db } from '../firebase.config';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction CreateListing() {\n  _s();\n\n  var _useState = useState({\n    name: '',\n    description: '',\n    location: '',\n    price: '',\n    type: 'sale',\n    images: {}\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      formData = _useState2[0],\n      setFormData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var auth = getAuth();\n  var navigate = useNavigate();\n  var isMounted = useRef(true);\n  useEffect(function () {\n    if (isMounted.current) {\n      onAuthStateChanged(auth, function (user) {\n        if (user) {\n          setFormData(function (prev) {\n            return _objectSpread(_objectSpread({}, prev), {}, {\n              userRef: user.uid\n            });\n          });\n        } else {\n          navigate('/sign-in');\n        }\n      });\n    }\n\n    return function () {\n      return isMounted.current = false;\n    };\n  }, [auth, navigate]);\n\n  var handleChange = function handleChange(e) {\n    if (e.target.files) {\n      setFormData(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          images: e.target.files\n        });\n      });\n    } else {\n      setFormData(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, _defineProperty({}, e.target.name, e.target.value));\n      });\n    }\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var storeImage, imgUrls, listingData, docRef;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n\n              if (!(formData.images.length > 6)) {\n                _context2.next = 6;\n                break;\n              }\n\n              setLoading(false);\n              toast.error('Maximum 6 images allowed');\n              return _context2.abrupt(\"return\");\n\n            case 6:\n              storeImage = /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(image) {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                            var storage = getStorage();\n                            var fileName = \"\".concat(auth.currentUser.uid, \"-\").concat(image.name, \"-\").concat(uuidv4());\n                            var storageRef = ref(storage, 'images/' + fileName);\n                            var uploadTask = uploadBytesResumable(storageRef, image);\n                            uploadTask.on('state_changed', null, function (error) {\n                              return reject(error);\n                            }, function () {\n                              getDownloadURL(uploadTask.snapshot.ref).then(resolve);\n                            });\n                          }));\n\n                        case 1:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function storeImage(_x2) {\n                  return _ref2.apply(this, arguments);\n                };\n              }();\n\n              _context2.prev = 7;\n              _context2.next = 10;\n              return Promise.all(_toConsumableArray(formData.images).map(function (img) {\n                return storeImage(img);\n              }));\n\n            case 10:\n              imgUrls = _context2.sent;\n              _context2.next = 18;\n              break;\n\n            case 13:\n              _context2.prev = 13;\n              _context2.t0 = _context2[\"catch\"](7);\n              setLoading(false);\n              toast.error('Image upload failed');\n              return _context2.abrupt(\"return\");\n\n            case 18:\n              listingData = _objectSpread(_objectSpread({}, formData), {}, {\n                imgUrls: imgUrls,\n                timestamp: serverTimestamp()\n              });\n              delete listingData.images;\n              _context2.prev = 20;\n              _context2.next = 23;\n              return addDoc(collection(db, 'listings'), listingData);\n\n            case 23:\n              docRef = _context2.sent;\n              toast.success('Listing created successfully');\n              navigate(\"/category/\".concat(listingData.type, \"/\").concat(docRef.id));\n              _context2.next = 32;\n              break;\n\n            case 28:\n              _context2.prev = 28;\n              _context2.t1 = _context2[\"catch\"](20);\n              console.error('Listing creation failed:', _context2.t1);\n              toast.error('Could not save listing');\n\n            case 32:\n              _context2.prev = 32;\n              setLoading(false);\n              return _context2.finish(32);\n\n            case 35:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[7, 13], [20, 28, 32, 35]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto p-6 bg-white rounded-xl shadow-lg mt-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-semibold text-center text-blue-700 mb-6\",\n      children: \"Create a Listing\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center text-sm text-gray-500 mb-4\",\n      children: \"Uploading... Please wait.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"name\",\n        placeholder: \"Item Name\",\n        value: formData.name,\n        onChange: handleChange,\n        className: \"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        name: \"description\",\n        placeholder: \"Item Description\",\n        value: formData.description,\n        onChange: handleChange,\n        className: \"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"location\",\n        placeholder: \"Location\",\n        value: formData.location,\n        onChange: handleChange,\n        className: \"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"price\",\n        type: \"number\",\n        placeholder: \"Price\",\n        value: formData.price,\n        onChange: handleChange,\n        className: \"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"inline-flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"type\",\n            value: \"sale\",\n            checked: formData.type === 'sale',\n            onChange: handleChange,\n            className: \"form-radio text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 text-gray-700\",\n            children: \"Sell\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"inline-flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"type\",\n            value: \"rent\",\n            checked: formData.type === 'rent',\n            onChange: handleChange,\n            className: \"form-radio text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 text-gray-700\",\n            children: \"Rent\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: \"Images (max 6)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"images\",\n          type: \"file\",\n          onChange: handleChange,\n          multiple: true,\n          accept: \".jpg,.png,.jpeg\",\n          className: \"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-200\",\n        children: \"Submit Listing\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateListing, \"qgFs0k/QPv1ILO7yGfEGOXsdGEk=\", false, function () {\n  return [useNavigate];\n});\n\n_c = CreateListing;\nexport default CreateListing;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateListing\");","map":{"version":3,"sources":["C:/Users/Asus/Desktop/house-marketing-main/src/pages/CreateListing.jsx"],"names":["useState","useEffect","useRef","getAuth","onAuthStateChanged","getStorage","ref","uploadBytesResumable","getDownloadURL","addDoc","collection","serverTimestamp","db","useNavigate","toast","v4","uuidv4","CreateListing","name","description","location","price","type","images","formData","setFormData","loading","setLoading","auth","navigate","isMounted","current","user","prev","userRef","uid","handleChange","e","target","files","value","handleSubmit","preventDefault","length","error","storeImage","image","Promise","resolve","reject","storage","fileName","currentUser","storageRef","uploadTask","on","snapshot","then","all","map","img","imgUrls","listingData","timestamp","docRef","success","id","console"],"mappings":"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","sourcesContent":["// src/pages/CreateListing.jsx (Enhanced Tailwind UI for General Item Listings)\n\nimport { useState, useEffect, useRef } from 'react';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport {\n  getStorage,\n  ref,\n  uploadBytesResumable,\n  getDownloadURL,\n} from 'firebase/storage';\nimport { addDoc, collection, serverTimestamp } from 'firebase/firestore';\nimport { db } from '../firebase.config';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { v4 as uuidv4 } from 'uuid';\n\nfunction CreateListing() {\n  const [formData, setFormData] = useState({\n    name: '',\n    description: '',\n    location: '',\n    price: '',\n    type: 'sale',\n    images: {},\n  });\n\n  const [loading, setLoading] = useState(false);\n  const auth = getAuth();\n  const navigate = useNavigate();\n  const isMounted = useRef(true);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      onAuthStateChanged(auth, (user) => {\n        if (user) {\n          setFormData((prev) => ({ ...prev, userRef: user.uid }));\n        } else {\n          navigate('/sign-in');\n        }\n      });\n    }\n    return () => (isMounted.current = false);\n  }, [auth, navigate]);\n\n  const handleChange = (e) => {\n    if (e.target.files) {\n      setFormData((prev) => ({ ...prev, images: e.target.files }));\n    } else {\n      setFormData((prev) => ({\n        ...prev,\n        [e.target.name]: e.target.value,\n      }));\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n\n    if (formData.images.length > 6) {\n      setLoading(false);\n      toast.error('Maximum 6 images allowed');\n      return;\n    }\n\n    const storeImage = async (image) => {\n      return new Promise((resolve, reject) => {\n        const storage = getStorage();\n        const fileName = `${auth.currentUser.uid}-${image.name}-${uuidv4()}`;\n        const storageRef = ref(storage, 'images/' + fileName);\n        const uploadTask = uploadBytesResumable(storageRef, image);\n\n        uploadTask.on(\n          'state_changed',\n          null,\n          (error) => reject(error),\n          () => {\n            getDownloadURL(uploadTask.snapshot.ref).then(resolve);\n          }\n        );\n      });\n    };\n\n    let imgUrls;\n    try {\n      imgUrls = await Promise.all(\n        [...formData.images].map((img) => storeImage(img))\n      );\n    } catch (error) {\n      setLoading(false);\n      toast.error('Image upload failed');\n      return;\n    }\n\n    const listingData = {\n      ...formData,\n      imgUrls,\n      timestamp: serverTimestamp(),\n    };\n\n    delete listingData.images;\n\n    try {\n      const docRef = await addDoc(collection(db, 'listings'), listingData);\n      toast.success('Listing created successfully');\n      navigate(`/category/${listingData.type}/${docRef.id}`);\n    } catch (err) {\n      console.error('Listing creation failed:', err);\n      toast.error('Could not save listing');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"max-w-2xl mx-auto p-6 bg-white rounded-xl shadow-lg mt-6\">\n      <h1 className=\"text-3xl font-semibold text-center text-blue-700 mb-6\">Create a Listing</h1>\n      {loading && <div className=\"text-center text-sm text-gray-500 mb-4\">Uploading... Please wait.</div>}\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <input name=\"name\" placeholder=\"Item Name\" value={formData.name} onChange={handleChange} className=\"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\n        <textarea name=\"description\" placeholder=\"Item Description\" value={formData.description} onChange={handleChange} className=\"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\n        <input name=\"location\" placeholder=\"Location\" value={formData.location} onChange={handleChange} className=\"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\n        <input name=\"price\" type=\"number\" placeholder=\"Price\" value={formData.price} onChange={handleChange} className=\"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\n\n        <div className=\"flex justify-center gap-6\">\n          <label className=\"inline-flex items-center\">\n            <input type=\"radio\" name=\"type\" value=\"sale\" checked={formData.type === 'sale'} onChange={handleChange} className=\"form-radio text-blue-600\" />\n            <span className=\"ml-2 text-gray-700\">Sell</span>\n          </label>\n          <label className=\"inline-flex items-center\">\n            <input type=\"radio\" name=\"type\" value=\"rent\" checked={formData.type === 'rent'} onChange={handleChange} className=\"form-radio text-blue-600\" />\n            <span className=\"ml-2 text-gray-700\">Rent</span>\n          </label>\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">Images (max 6)</label>\n          <input name=\"images\" type=\"file\" onChange={handleChange} multiple accept=\".jpg,.png,.jpeg\" className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\" required />\n        </div>\n\n        <button type=\"submit\" className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-200\">Submit Listing</button>\n      </form>\n    </div>\n  );\n}\n\nexport default CreateListing;\n"]},"metadata":{},"sourceType":"module"}